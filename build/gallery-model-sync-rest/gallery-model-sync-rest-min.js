YUI.add("gallery-model-sync-rest",function(e,t){function a(){}var n=e.Lang,r=n.sub,i=n.isValue,s=n.isString,o=n.isNumber,u=n.isFunction;a.HTTP_METHODS={create:"POST",read:"GET",update:"PUT","delete":"DELETE"},a.HTTP_HEADERS={Accept:"application/json","Content-Type":"application/json"},a.HTTP_TIMEOUT=3e4,a.EMULATE_HTTP=!1,a.CSRF_TOKEN=YUI.Env.CSRF_TOKEN,a._NON_ATTRS_CFG=["root","url"],a.prototype={root:"",url:function(){var e=this.root,t;return this._isYUIModelList||this.isNew()?e:(t=this.getAsURL("id"),e&&e.charAt(e.length-1)==="/"&&(t+="/"),this._joinURL(t))},initializer:function(e){e||(e={}),i(e.url)&&(this.url=e.url)},sync:function(t,n,r){n||(n={});var i=this._getURL(t),s=a.HTTP_METHODS[t],o=e.merge(a.HTTP_HEADERS,n.headers),f=n.timeout||a.HTTP_TIMEOUT,l=n.csrfToken||a.CSRF_TOKEN,c;s==="POST"||s==="PUT"?c=this._serialize():delete o["Content-Type"],a.EMULATE_HTTP&&(s==="PUT"||s==="DELETE")&&(o["X-HTTP-Method-Override"]=s,s="POST"),l&&(s==="POST"||s==="PUT"||s==="DELETE")&&(o["X-CSRF-Token"]=l),e.io(i,{method:s,headers:o,data:c,timeout:f,on:{success:function(e,t){u(r)&&r(null,t.responseText)},failure:function(e,t){u(r)&&r({code:t.status,msg:t.statusText},t.responseText)}}})},_getURL:function(t){var n=this.url,i;return u(n)?this.url(t):(this._isYUIModel&&(i={},e.Object.each(this.toJSON(),function(e,t){if(s(e)||o(e))i[t]=encodeURIComponent(e)}),n=r(n,i)),n||this.root)},_joinURL:function(e){var t=this.root;return e.charAt(0)==="/"&&(e=e.substring(1)),t&&t.charAt(t.length-1)==="/"?t+e:t+"/"+e},_serialize:function(){return e.JSON.stringify(this)}},e.namespace("ModelSync").REST=a},"@VERSION@",{supersedes:[""],skinnable:"false",requires:["model","model-list","io-base","json-stringify"],optional:[""]});
