YUI.add("gallery-view-bind-datastick",function(e,t){function n(){}n._handlers=[],n.addHandler=function(t){t=e.Array.map(e.Array.flatten([t]),function(t){return e.mix({updateModel:!0,updateView:!0,updateMethod:"text"},t)}),this._handlers=this._handlers.concat(t)},n.prototype={_modelBindings:null,unbindAttrs:function(t){e.Array.each(this._modelBindings,e.bind(function(e,n){if(t&&e.model!==t)return!1;e.model.detach(e.event,e.fn),delete this._modelBindings[n]},this)),this._modelBindings=e.Array.filter(this._modelBindings,function(e){return e}),this.get("container").detach("stick"+(t?":"+t.get("clientId"):""))},bindAttrs:function(t,n){var r=this,s=t||this.model,p="stick:"+s.get("clientId"),d=n||this.bindings||{};this._modelBindings||(this._modelBindings=[]),this.unbindAttrs(t),e.Array.each(e.Object.keys(d),function(t){var n,v,m,g,y=d[t]||{},b=e.guid();t!="container"?n=r.get("container").all(t):(n=e.NodeList(r.get("container")),t="");if(n.isEmpty())return;e.Lang.isString(y)&&(y={observe:y}),g=f(n,y),m=g.observe,v=e.mix({bindKey:b},g.setOptions||{}),l(r,n,g,s,m),c(r,n,g,s,m),m&&(e.Array.each(g.events||[],function(e){var n=e+p,i=function(e){o(r,g.updateModel,val,g)&&u(s,m,val,v,r,g)};t===""?r.get("container").on(n,i):r.get("container").on(n,t,i)}),e.Array.each(e.Array.flatten([m]),function(e){observeModelEvent(s,r,e+"Change",function(e,t,i){(i==null||i.bindKey!=b)&&h(r,n,a(e,m,g,r),e)})}),h(r,n,g,a(s,m,g,r),s,!0)),i(r,g.initialize,n,s,g)}),this._originalDestroy=this.destroy,this.destroy=function(){r.unbindAttrs(),r._originalDestroy&&r._originalDestroy.apply(arguments)}}};var r=function(t,n){var r=(n||"").split("."),i=e.Array.reduce(r,t,function(e,t){return e[t]});return i==null?t:i},i=function(t,n){if(n)return(e.Lang.isString(n)?t[n]:n).apply(t,e.Array(arguments,2))},s=function(e){return e.get("options").filter(function(e){return e.selected})},o=function(t,n){return e.Lang.isBoolean(n)?n:e.Lang.isFunction(n)||e.Lang.isString(n)?i.apply(this,e.Array(arguments)):!1},u=function(e,t,n,r,s,o){o.onSet&&(n=i(s,o.onSet,n,o)),e.set(t,n,r)},a=function(t,n,r,s){var o,u=function(n){var i=r.escape?e.Escape.html(t.get(n)):t.get(n);return e.Lang.isUndefined(i)||e.Lang.isNull(i)?"":i};return o=e.Lang.isArray(n)?e.Array.map(n,u):u(n),r.onGet?i(s,r.onGet,o,r):o},f=function(t,r){var i=[{updateModel:!1,updateView:!0,updateMethod:"text",update:function(e,t,n,r){e[r.updateMethod](t)},getVal:function(e,t,n){return e[n.updateMethod]()}}];e.Array.each(n._handlers,function(e){t.test(e.selector)&&i.push(e)}),i.push(r);var s=e.mix.apply(e,i);return delete s.selector,s},l=function(t,n,r,i,s){var o=["autofocus","autoplay","async","checked","controls","defer","disabled","hidden","loop","multiple","open","readonly","required","scoped","selected"];e.Array.each(r.attributes||[],function(r){var u="",f=r.observe||(r.observe=s),l=function(){var s=e.Array.indexOf(o,r.name,!0)>-1,l=s?"prop":"attr",c=a(i,f,r,t);r.name==="class"?(n.removeClass(u).addClass(c),u=c):n[l](r.name,c)};e.Array.each(e.Array.flatten([f]),function(e){observeModelEvent(i,t,e+"Change",l)}),l()})},c=function(t,n,r,s,o){if(r.visible==null)return;var u=function(){var u=r.visible,f=r.visibleFn,l=a(s,o,r,t),c=!!l;if(e.Lang.isFunction(u)||e.Lang.isString(u))c=i(t,u,l,r);f?i(t,f,n,c,r):c?n.show():n.hide()};e.Array.each(e.Array.flatten([o]),function(e){observeModelEvent(s,t,e+"Change",u)}),u()},h=function(e,t,n,r,s,u){if(!o(e,n.updateView,r,n))return;n.update.call(e,t,r,s,n),u||i(e,n.afterUpdate,t,r,n)};n.addHandler([{selector:'[contenteditable="true"]',updateMethod:"html",events:["keyup","change","paste","cut"]},{selector:"input",events:["keyup","change","paste","cut"],update:function(e,t){e.set("value",t)},getVal:function(e){var t=e.get("value");return e.test('[type="number"]')?t==null?t:Number(t):t}},{selector:'input[type="radio"]',events:["change"],update:function(e,t){e.filter('[value="'+t+'"]').set("checked",!0)},getVal:function(e){return e.filter(function(e){return e.checked}).item(0).get("value")}},{selector:'input[type="checkbox"]',events:["change"],update:function(t,n,r,i){t.size()>1?e.Array.each(t,function(t){e.Array.indexOf(n,e.one(t).get("value"))>-1?e.one(t).set("checked",!0):e.one(t).set("checked",!1)}):e.Lang.isBoolean(n)?t.item(0).set("checked",n):t.item(0).set("checked",n==t.item(0).get("value"))},getVal:function(e){var t;if(e.size()>1)t=[],e.each(function(e){e.get("checked")&&t.push(e.get("value"))});else{var n=e.item(0),r;t=n.get("checked"),r=n.get("value"),r!="on"&&r!=null&&(t?t=n.get("value"):t=null)}return t}}]),e.namespace("DataBind").Stick=n},"@VERSION@",{requires:["view"]});
